# 権限設定ガイド

## 権限の種類

| 権限 | 説明 | アクセス可能な機能 |
|------|------|-------------------|
| **admin（管理者）** | 全機能にアクセス可能 | すべての機能 |
| **staff（スタッフ）** | 基本機能のみ | シフト表閲覧、自分の給与明細、休み希望 |

## 権限設定方法

### 方法1: Firebaseコンソールから設定（推奨）

1. **Firebase Console にアクセス**
   - https://console.firebase.google.com/
   - プロジェクト「shift-management-2」を選択

2. **Firestore Database を開く**
   - 左メニューから「Firestore Database」をクリック

3. **helpers コレクションで設定**
   ```
   helpers（コレクション）
   └── [ヘルパーID]（ドキュメント）
       ├── email: "user@example.com"
       ├── name: "山田太郎"
       └── role: "admin"  ← ここを変更
   ```

4. **roleフィールドを編集**
   - `admin` : 管理者権限
   - `staff` : スタッフ権限（またはフィールド削除でデフォルト）

### 方法2: 特別な管理者アカウント

**info@alhena.co.jp** は自動的に管理者権限が付与されます（ハードコーディング）

### 方法3: プログラムから設定

```javascript
// helpers コレクションのドキュメントを更新
const helperRef = doc(db, 'helpers', 'ヘルパーID');
await updateDoc(helperRef, {
  role: 'admin'  // または 'staff'
});
```

## 権限の確認方法

### 1. ログイン後の表示で確認

- **管理者の場合**
  - ヘッダーに「管理者モード」と表示
  - ホーム画面で管理者バッジが表示
  - すべてのメニューが表示

- **スタッフの場合**
  - ヘッダーに「スタッフモード」と表示
  - ホーム画面でスタッフバッジが表示
  - 制限されたメニューのみ表示

### 2. Firestoreで確認

1. Firebase Console を開く
2. Firestore > helpers コレクション
3. 対象ユーザーのドキュメントを確認
4. `role` フィールドの値を確認

## 権限による機能制限

### 管理者のみアクセス可能な機能

- 👥 ヘルパー管理
- 👤 利用者管理
- 📝 従業員フォーム管理
- 📊 交通費・経費
- 📋 翌月へ反映
- ☁️ 内部バックアップ
- 🗑️ シフトデータ削除

### スタッフもアクセス可能な機能

- 📅 ヘルパーシフト管理（閲覧のみ）
- 💰 給与計算（自分の分のみ）
- 🏖️ 休み希望

## トラブルシューティング

### Q: 権限を変更したのに反映されない

A: 以下を試してください：
1. ログアウトして再ログイン
2. ブラウザのキャッシュをクリア
3. Firestoreで`users`コレクションも確認（自動同期されるはず）

### Q: 管理者権限を付与したい

A: Firebaseコンソールで：
1. helpers コレクション → 対象ユーザー選択
2. roleフィールドを「admin」に設定
3. 保存

### Q: デフォルトの権限は？

A: 新規登録ユーザーのデフォルトは「staff」権限です

## セキュリティの注意点

- 管理者権限は信頼できるユーザーのみに付与
- 定期的に権限の見直しを実施
- 不要になった管理者権限は速やかに削除